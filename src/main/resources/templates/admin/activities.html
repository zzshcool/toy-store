<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<body>
    <!-- Activities Management Fragment -->
    <div th:fragment="content" id="activities" class="tab-content" style="display:none;">
        <h3>Ê¥ªÂãïÁÆ°ÁêÜ</h3>
        <div class="card" style="padding: 20px; margin-bottom: 20px;">
            <h4>Êñ∞Â¢ûÊ¥ªÂãï</h4>
            <form th:action="@{/admin/activities}" method="post" th:object="${newActivity}">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <input type="text" name="title" placeholder="Ê®ôÈ°å" class="form-control" required />
                    <input type="text" name="type" placeholder="È°ûÂûã (‰æãÂ¶Ç: SALE)" class="form-control" required />
                    <input type="datetime-local" name="startDate" class="form-control" placeholder="ÈñãÂßãÊôÇÈñì" />
                    <input type="datetime-local" name="expiryDate" class="form-control" placeholder="ÁµêÊùüÊôÇÈñì" />
                    <input type="text" name="imageUrl" placeholder="ÂúñÁâá URL" class="form-control" />
                    <textarea name="description" placeholder="ÂÖßÂÆπ" class="form-control"
                        style="grid-column: span 2"></textarea>
                </div>
                <button type="submit" class="btn btn-primary" style="margin-top: 10px;">Êñ∞Â¢û</button>
            </form>
        </div>
        <table>
            <thead>
                <tr>
                    <th>Ê®ôÈ°å</th>
                    <th>È°ûÂûã</th>
                    <th>ÈñãÂßãÊôÇÈñì</th>
                    <th>ÁµêÊùüÊôÇÈñì</th>
                    <th>ÁãÄÊÖã</th>
                    <th>Êìç‰Ωú</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="act : ${activities}">
                    <td th:text="${act.title}">Title</td>
                    <td th:text="${act.type}">SALE</td>
                    <td th:text="${act.startDate != null ? #temporals.format(act.startDate, 'yyyy-MM-dd HH:mm') : '-'}">
                        Start</td>
                    <td
                        th:text="${act.expiryDate != null ? #temporals.format(act.expiryDate, 'yyyy-MM-dd HH:mm') : '-'}">
                        End</td>
                    <td>
                        <form th:action="@{/admin/activities/toggle/{id}(id=${act.id})}" method="post" style="margin:0;"
                            onsubmit="if(![[${act.active}]]) return true; return confirm('Á¢∫ÂÆöË¶ÅÈóúÈñâÊ¥ªÂãïÂóéÔºü');">
                            <button type="submit" class="btn btn-sm"
                                th:classappend="${act.active ? 'btn-success' : 'btn-secondary'}"
                                th:text="${act.active ? 'ÂïüÁî®' : 'ÂÅúÁî®'}">Active</button>
                        </form>
                    </td>
                    <td>
                        <button class="btn btn-sm btn-info"
                            th:onclick="editActivity([[${act.id}]], '[[${act.title}]]', '[[${act.description}]]', '[[${act.type}]]', '[[${act.startDate}]]', '[[${act.expiryDate}]]')">‚úèÔ∏è</button>
                        <form th:action="@{/admin/activities/delete/{id}(id=${act.id})}" method="post"
                            style="display:inline;" onsubmit="return confirm('Á¢∫ÂÆöÂà™Èô§Ôºü');">
                            <button type="submit" style="background:none;border:none;cursor:pointer;"
                                title="Âà™Èô§">üóëÔ∏è</button>
                        </form>
                    </td>
                </tr>
            </tbody>
        </table>

        <!-- Edit Activity Modal -->
        <div id="editActivityModal" class="modal"
            style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5);">
            <div class="card" style="margin: 10% auto; width: 50%; padding: 20px;">
                <h4>Á∑®ËºØÊ¥ªÂãï</h4>
                <form th:action="@{/admin/activities/update}" method="post">
                    <input type="hidden" id="editActId" name="id">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                        <input type="text" id="editActTitle" name="title" placeholder="Ê®ôÈ°å" class="form-control"
                            required />
                        <input type="text" id="editActType" name="type" placeholder="È°ûÂûã" class="form-control"
                            required />
                        <input type="datetime-local" id="editActStart" name="startDate" class="form-control"
                            placeholder="ÈñãÂßãÊôÇÈñì" />
                        <input type="datetime-local" id="editActEnd" name="expiryDate" class="form-control"
                            placeholder="ÁµêÊùüÊôÇÈñì" />
                        <textarea id="editActDesc" name="description" placeholder="ÂÖßÂÆπ" class="form-control"
                            style="grid-column: span 2"></textarea>
                    </div>
                    <div style="margin-top: 10px; display: flex; justify-content: flex-end; gap: 10px;">
                        <button type="button" class="btn btn-secondary"
                            onclick="document.getElementById('editActivityModal').style.display='none'">ÂèñÊ∂à</button>
                        <button type="submit" class="btn btn-primary">ÂÑ≤Â≠ò</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</body>

</html>