<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<body>
    <!-- Product Management Fragment -->
    <div th:fragment="content" id="products" class="tab-content" style="display:none;">
        <h3>商品管理</h3>
        <div class="card" style="padding: 20px; margin-bottom: 20px;">
            <h4>新增商品</h4>
            <form th:action="@{/admin/products}" method="post" th:object="${newProduct}">
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                    <input type="text" name="name" placeholder="名稱" class="form-control" required />
                    <input type="number" step="0.01" name="price" placeholder="價格" class="form-control" required />
                    <input type="number" name="stock" placeholder="庫存" class="form-control" required />
                    <select id="prodCategory" name="category" class="form-control" onchange="loadSubCats(this.value)"
                        required>
                        <option value="">選擇大分類</option>
                        <option th:each="cat : ${categories}" th:value="${cat.id}" th:text="${cat.name}"></option>
                    </select>
                    <select id="prodSubCategory" name="subCategory" class="form-control" required>
                        <option value="">選擇子分類</option>
                    </select>
                </div>
                <button type="submit" class="btn btn-primary" style="margin-top: 10px;">新增</button>
            </form>
        </div>
        <table>
            <thead>
                <tr>
                    <th>ID</th>
                    <th>名稱</th>
                    <th>分類</th>
                    <th>子分類</th>
                    <th>價格</th>
                    <th>庫存</th>
                    <th>操作</th>
                </tr>
            </thead>
            <tbody>
                <tr th:each="product : ${products}">
                    <td th:text="${product.id}">1</td>
                    <td th:text="${product.name}">Toy</td>
                    <td th:text="${product.category != null ? product.category : '-'}">Cat</td>
                    <td th:text="${product.subCategory != null ? product.subCategory : '-'}">Sub</td>
                    <td th:text="${product.price}">100</td>
                    <td th:text="${product.stock}">10</td>
                    <td style="display: flex; gap: 5px;">
                        <button class="btn btn-sm btn-info" title="編輯">編輯</button>
                        <form th:action="@{/admin/products/delete/{id}(id=${product.id})}" method="post"
                            style="display:inline;" onsubmit="return confirm('確定刪除？');">
                            <button type="submit" class="btn btn-sm btn-danger" title="刪除">刪除</button>
                        </form>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</body>

</html>